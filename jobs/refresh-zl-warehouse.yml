type: "job-pipeline"
description: "Refreshing ZL data"
schedule:
  cron: "${executeCron.refreshZlWarehouse}"
configuration:
  jobs:
    - type: "iterating-job"
      description: "Refreshing OpenMRS Data for all sites"
      configuration:
        maxConcurrentJobs: 5  # Import into up to 5 sites concurrently
        errorHandling:
          maxAttempts: 3
          retryInterval: 60
          retryIntervalUnit: "MINUTES"
        iterations:
          - siteName: "cange"
          - siteName: "hinche"
          - siteName: "saint_marc_hsn"
          - siteName: "lacolline"
          - siteName: "thomonde"
          - siteName: "mirebalais"
          - siteName: "hiv"
        jobTemplate:
          path: "refresh-${siteName}.yml"

    - path: "refresh-derived-tables.yml"
